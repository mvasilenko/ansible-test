---
- name: Verify
  hosts: all
  gather_facts: true
  tasks:
    - name: Get packages facts
      ansible.builtin.package_facts:
        manager: auto

    - name: Debug
      ansible.builtin.debug:
        msg: "{{ ansible_facts.packages['curl'] }}"

    - name: Verify if packages are installed
      ansible.builtin.assert:
        that: "'{{ line_item }}' in ansible_facts.packages"
        fail_msg: "FAIL: Package '{{ line_item }}' is not installed!"
        success_msg: "PASS: Package '{{ line_item }}' is installed."
      with_items:
        - "{{ packages }}"
      loop_control:
        loop_var: line_item
